{% extends "base.html" %}

{% block title %}QR Design{% endblock %}

{% block styles %}
<style>
</style>
{% endblock %}

{% block content %}
<div class="design-container row g-0">
    <!-- Configuration -->
    <div class="col-lg-5 config-pane">
        <div class="mb-4">
            <h2 class="fw-bold">QR Customization</h2>
            <p class="text-muted">Personalize the QR code for your tables.</p>
        </div>

        <form method="POST" class="mt-4">
            <div class="card border-0 bg-light mb-4">
                <div class="card-body">
                    <label class="form-label small fw-bold text-uppercase text-muted">QR Foreground Color</label>
                    <div class="d-flex align-items-center gap-3">
                        <input type="color" name="color" id="color-input" class="form-control form-control-color border-0 bg-transparent" value="#{{ config.color or '000000' }}">
                        <span class="text-muted font-monospace small">#<span id="fg-hex">000000</span></span>
                    </div>
                </div>
            </div>

            <div class="card border-0 bg-light mb-4">
                <div class="card-body">
                    <label class="form-label small fw-bold text-uppercase text-muted">Background Color</label>
                    <div class="d-flex align-items-center gap-3">
                        <input type="color" name="bgcolor" id="bgcolor-input" class="form-control form-control-color border-0 bg-transparent" value="#{{ config.bgcolor or 'ffffff' }}">
                        <span class="text-muted font-monospace small">#<span id="bg-hex">ffffff</span></span>
                    </div>
                </div>
            </div>

            <div class="alert alert-info border-0 flex-grow-1 mb-4" style="background: rgba(99, 102, 241, 0.05); color: var(--primary-color);">
                <i class="bi bi-info-circle-fill me-2"></i>
                High contrast (Dark on Light) ensures faster scanning on older devices.
            </div>

            <button type="submit" class="btn btn-primary w-100 py-3 rounded-pill">
                Save & Generate
            </button>
        </form>
    </div>

    <!-- Preview -->
    <div class="col-lg-7 preview-pane">
        <div class="text-center">
            <div class="qr-card">
                <img id="qr-preview" src="" alt="QR Preview" class="img-fluid" style="width: 250px; height: 250px; image-rendering: pixelated;">
            </div>
            <p class="mt-4 text-muted fw-medium">Live QR Preview</p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function updatePreview() {
        const color = document.getElementById('color-input').value.replace('#', '');
        const bgcolor = document.getElementById('bgcolor-input').value.replace('#', '');
        
        document.getElementById('fg-hex').textContent = color.toUpperCase();
        document.getElementById('bg-hex').textContent = bgcolor.toUpperCase();
        
        const url = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=PREVIEW&color=${color}&bgcolor=${bgcolor}`;
        document.getElementById('qr-preview').src = url;
    }
    document.querySelectorAll('input[type=color]').forEach(input => input.addEventListener('input', updatePreview));
    updatePreview();
</script>
{% endblock %}